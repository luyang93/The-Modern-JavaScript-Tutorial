<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <style>
        body,
        html {
            margin: 0;
            padding: 0;
        }

        #container {
            border: 1px solid brown;
            padding: 10px;
            width: 330px;
            margin-bottom: 5px;
            box-sizing: border-box;
        }

        #log {
            height: 120px;
            width: 350px;
            display: block;
            box-sizing: border-box;
        }

        [class^="smiley-"] {
            display: inline-block;
            width: 70px;
            height: 70px;
            border-radius: 50%;
            margin-right: 20px;
        }

        .smiley-green {
            background: #a9db7a;
            border: 5px solid #92c563;
            position: relative;
        }

        .smiley-green .left-eye {
            width: 18%;
            height: 18%;
            background: #84b458;
            position: relative;
            top: 29%;
            left: 22%;
            border-radius: 50%;
            float: left;
        }

        .smiley-green .right-eye {
            width: 18%;
            height: 18%;
            border-radius: 50%;
            position: relative;
            background: #84b458;
            top: 29%;
            right: 22%;
            float: right;
        }

        .smiley-green .smile {
            position: absolute;
            top: 67%;
            left: 16.5%;
            width: 70%;
            height: 20%;
            overflow: hidden;
        }

        .smiley-green .smile:after,
        .smiley-green .smile:before {
            content: "";
            position: absolute;
            top: -50%;
            left: 0%;
            border-radius: 50%;
            background: #84b458;
            height: 100%;
            width: 97%;
        }

        .smiley-green .smile:after {
            background: #84b458;
            height: 80%;
            top: -40%;
            left: 0%;
        }

        .smiley-yellow {
            background: #eed16a;
            border: 5px solid #dbae51;
            position: relative;
        }

        .smiley-yellow .left-eye {
            width: 18%;
            height: 18%;
            background: #dba652;
            position: relative;
            top: 29%;
            left: 22%;
            border-radius: 50%;
            float: left;
        }

        .smiley-yellow .right-eye {
            width: 18%;
            height: 18%;
            border-radius: 50%;
            position: relative;
            background: #dba652;
            top: 29%;
            right: 22%;
            float: right;
        }

        .smiley-yellow .smile {
            position: absolute;
            top: 67%;
            left: 19%;
            width: 65%;
            height: 14%;
            background: #dba652;
            overflow: hidden;
            border-radius: 8px;
        }

        .smiley-red {
            background: #ee9295;
            border: 5px solid #e27378;
            position: relative;
        }

        .smiley-red .left-eye {
            width: 18%;
            height: 18%;
            background: #d96065;
            position: relative;
            top: 29%;
            left: 22%;
            border-radius: 50%;
            float: left;
        }

        .smiley-red .right-eye {
            width: 18%;
            height: 18%;
            border-radius: 50%;
            position: relative;
            background: #d96065;
            top: 29%;
            right: 22%;
            float: right;
        }

        .smiley-red .smile {
            position: absolute;
            top: 57%;
            left: 16.5%;
            width: 70%;
            height: 20%;
            overflow: hidden;
        }

        .smiley-red .smile:after,
        .smiley-red .smile:before {
            content: "";
            position: absolute;
            top: 50%;
            left: 0%;
            border-radius: 50%;
            background: #d96065;
            height: 100%;
            width: 97%;
        }

        .smiley-red .smile:after {
            background: #d96065;
            height: 80%;
            top: 60%;
            left: 0%;
        }
    </style>
    <style>
        [id^=parent] {
            background: #99C0C3;
            width: 160px;
            height: 120px;
            position: relative;
        }

        [id^=child] {
            background: #FFDE99;
            width: 50%;
            height: 50%;
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
        }

        textarea {
            height: 140px;
            width: 300px;
            display: block;
        }
    </style>
    <style>
        #text5 #text6 {
            display: block;
            height: 100px;
            width: 456px;
        }

        [id^=table] th {
            text-align: center;
            font-weight: bold;
        }

        [id^=table] td {
            width: 150px;
            white-space: nowrap;
            text-align: center;
            vertical-align: bottom;
            padding-top: 5px;
            padding-bottom: 12px;
            cursor: pointer;
        }

        [id^=table] .nw {
            background: #999;
        }

        [id^=table] .n {
            background: #03f;
            color: #fff;
        }

        [id^=table] .ne {
            background: #ff6;
        }

        [id^=table] .w {
            background: #ff0;
        }

        [id^=table] .c {
            background: #60c;
            color: #fff;
        }

        [id^=table] .e {
            background: #09f;
            color: #fff;
        }

        [id^=table] .sw {
            background: #963;
            color: #fff;
        }

        [id^=table] .s {
            background: #f60;
            color: #fff;
        }

        [id^=table] .se {
            background: #0c3;
            color: #fff;
        }

        [id^=table] .highlight {
            background: red;
        }
    </style>
    <style>
        body {
            height: 20000px;
            /* 在页面滚动后，工具提示也应该正常展示 */
        }

        .tooltip {
            position: fixed;
            z-index: 100;
            padding: 10px 20px;
            border: 1px solid #b3c9ce;
            border-radius: 4px;
            text-align: center;
            font: italic 14px/1.3 sans-serif;
            color: #333;
            background: #fff;
            box-shadow: 3px 3px 3px rgba(0, 0, 0, .3);
        }

        #house {
            margin-top: 50px;
            width: 400px;
            border: 1px solid brown;
        }

        #roof {
            width: 0;
            height: 0;
            border-left: 200px solid transparent;
            border-right: 200px solid transparent;
            border-bottom: 20px solid brown;
            margin-top: -20px;
        }

        p {
            text-align: justify;
            margin: 10px 3px;
        }
    </style>
    <style>
        .hours {
            color: red;
        }

        body {
            margin: 0;
        }

        .minutes {
            color: green;
        }

        .seconds {
            color: blue;
        }

        .clock {
            border: 1px dashed black;
            padding: 5px;
            display: inline-block;
            background: yellow;
            position: absolute;
            /*left: 0;*/
            /*top: 0;*/
        }

        #tooltip2 {
            position: fixed;
            padding: 10px 20px;
            border: 1px solid #b3c9ce;
            border-radius: 4px;
            text-align: center;
            font: italic 14px/1.3 sans-serif;
            color: #333;
            background: #fff;
            z-index: 100000;
            box-shadow: 3px 3px 3px rgba(0, 0, 0, .3);
        }
    </style>
    <script src="https://en.js.cx/test/libs.js"></script>
    <script src="test.js"></script>
</head>
<body>
<div id="container">
    <div class="smiley-green">
        <div class="left-eye"></div>
        <div class="right-eye"></div>
        <div class="smile"></div>
    </div>

    <div class="smiley-yellow">
        <div class="left-eye"></div>
        <div class="right-eye"></div>
        <div class="smile"></div>
    </div>

    <div class="smiley-red">
        <div class="left-eye"></div>
        <div class="right-eye"></div>
        <div class="smile"></div>
    </div>
</div>
<textarea id="log">Events will show up here!
</textarea>
<script>
  container.onmouseover = container.onmouseout = handler;

  function handler(event) {
    function str(el) {
      if (!el) return 'null';
      return el.className || el.tagName;
    }

    log.value += event.type + ':  ' +
        'target=' + str(event.target) +
        ',  relatedTarget=' + str(event.relatedTarget) + '\n';
    log.scrollTop = log.scrollHeight;

    if (event.type == 'mouseover') {
      event.target.style.background = 'pink';
    }

    if (event.type == 'mouseout') {
      event.target.style.background = '';
    }
  }
</script>
<div id="parent">parent
    <div id="child">child</div>
</div>
<textarea id="text2"></textarea>
<input onclick="clearText()" value="Clear" type="button">
<script>
  let parent = document.getElementById('parent');
  parent.onmouseover = parent.onmouseout = parent.onmousemove = handler;

  function handler(event) {
    let type = event.type;
    while (type.length < 11) type += ' ';

    log2(type + ' target=' + event.target.id);
    return false;
  }

  function clearText() {
    text2.value = '';
    lastMessage = '';
  }

  let lastMessageTime = 0;
  let lastMessage = '';
  let repeatCounter = 1;

  function log2(message) {
    if (lastMessageTime == 0) lastMessageTime = new Date();

    let time = new Date();

    if (time - lastMessageTime > 500) {
      message = '------------------------------\n' + message;
    }

    if (message === lastMessage) {
      repeatCounter++;
      if (repeatCounter == 2) {
        text2.value = text2.value.trim() + ' x 2\n';
      } else {
        text2.value = text2.value.slice(0, text2.value.lastIndexOf('x') + 1) + repeatCounter + '\n';
      }

    } else {
      repeatCounter = 1;
      text2.value += message + '\n';
    }

    text2.scrollTop = text2.scrollHeight;

    lastMessageTime = time;
    lastMessage = message;
  }
</script>
<br>
<div id="parent3" onmouseover="mouselog3(event)" onmouseout="mouselog3(event)">parent
    <div id="child3">child</div>
</div>
<textarea id="text3"></textarea>
<input type="button" onclick="text3.value=''" value="Clear">
<script>
  function mouselog3(event) {
    let d = new Date();
    text3.value += `${d.getHours()}:${d.getMinutes()}:${d.getSeconds()} | ${event.type} [target: ${event.target.id}]\n`.
        replace(/(:|^)(\d\D)/, '$10$2');
    text3.scrollTop = text3.scrollHeight;
  }
</script>
<div id="parent4" onmouseenter="mouselog4(event)" onmouseleave="mouselog4(event)">parent
    <div id="child4">child</div>
</div>
<textarea id="text4"></textarea>
<input type="button" onclick="text4.value=''" value="Clear">
<script>
  function mouselog4(event) {
    let d = new Date();
    text4.value += `${d.getHours()}:${d.getMinutes()}:${d.getSeconds()} | ${event.type} [target: ${event.target.id}]\n`.replace(
        /(:|^)(\d\D)/, '$10$2');
    text4.scrollTop = text4.scrollHeight;
  }
</script>
<table id="table5">
    <tr>
        <th colspan="3"><em>Bagua</em> Chart: Direction, Element, Color, Meaning</th>
    </tr>
    <tr>
        <td class="nw"><strong>Northwest</strong>
            <br>Metal
            <br>Silver
            <br>Elders
        </td>
        <td class="n"><strong>North</strong>
            <br>Water
            <br>Blue
            <br>Change
        </td>
        <td class="ne"><strong>Northeast</strong>
            <br>Earth
            <br>Yellow
            <br>Direction
        </td>
    </tr>
    <tr>
        <td class="w"><strong>West</strong>
            <br>Metal
            <br>Gold
            <br>Youth
        </td>
        <td class="c"><strong>Center</strong>
            <br>All
            <br>Purple
            <br>Harmony
        </td>
        <td class="e"><strong>East</strong>
            <br>Wood
            <br>Blue
            <br>Future
        </td>
    </tr>
    <tr>
        <td class="sw"><strong>Southwest</strong>
            <br>Earth
            <br>Brown
            <br>Tranquility
        </td>
        <td class="s"><strong>South</strong>
            <br>Fire
            <br>Orange
            <br>Fame
        </td>
        <td class="se"><strong>Southeast</strong>
            <br>Wood
            <br>Green
            <br>Romance
        </td>
    </tr>
</table>
<textarea id="text5"></textarea>
<input type="button" onclick="text5.value=''" value="Clear">
<script>
  let table5 = document.getElementById('table5');

  table5.onmouseover = function(event) {
    let target = event.target;
    target.style.background = 'pink';

    text5.value += `over -> ${target.tagName}\n`;
    text5.scrollTop = text5.scrollHeight;
  };

  table5.onmouseout = function(event) {
    let target = event.target;
    target.style.background = '';

    text5.value += `out <- ${target.tagName}\n`;
    text5.scrollTop = text5.scrollHeight;
  };
</script>
<table id="table6">
    <tr>
        <th colspan="3"><em>Bagua</em> Chart: Direction, Element, Color, Meaning</th>
    </tr>
    <tr>
        <td class="nw"><strong>Northwest</strong>
            <br>Metal
            <br>Silver
            <br>Elders
        </td>
        <td class="n"><strong>North</strong>
            <br>Water
            <br>Blue
            <br>Change
        </td>
        <td class="ne"><strong>Northeast</strong>
            <br>Earth
            <br>Yellow
            <br>Direction
        </td>
    </tr>
    <tr>
        <td class="w"><strong>West</strong>
            <br>Metal
            <br>Gold
            <br>Youth
        </td>
        <td class="c"><strong>Center</strong>
            <br>All
            <br>Purple
            <br>Harmony
        </td>
        <td class="e"><strong>East</strong>
            <br>Wood
            <br>Blue
            <br>Future
        </td>
    </tr>
    <tr>
        <td class="sw"><strong>Southwest</strong>
            <br>Earth
            <br>Brown
            <br>Tranquility
        </td>
        <td class="s"><strong>South</strong>
            <br>Fire
            <br>Orange
            <br>Fame
        </td>
        <td class="se"><strong>Southeast</strong>
            <br>Wood
            <br>Green
            <br>Romance
        </td>
    </tr>
</table>
<textarea id="text6"></textarea>
<script>
  // 现在位于鼠标下方的 <td>（如果有）
  let currentElem = null;
  let table6 = document.getElementById('table6');

  table6.onmouseover = function(event) {
    // 在进入一个新的元素前，鼠标总是会先离开前一个元素
    // 如果设置了 currentElem，那么我们就没有鼠标所悬停在的前一个 <td>，
    // 忽略此事件
    if (currentElem) return;

    let target = event.target.closest('td');

    // 我们移动到的不是一个 <td> —— 忽略
    if (!target) return;

    // 现在移动到了 <td> 上，但在处于了我们表格的外部（可能因为是嵌套的表格）
    // 忽略
    if (!table6.contains(target)) return;

    // 给力！我们进入了一个新的 <td>
    currentElem = target;
    onEnter(currentElem);
  };

  table6.onmouseout = function(event) {
    // 如果我们现在处于所有 <td> 的外部，则忽略此事件
    // 这可能是一个表格内的移动，但是在 <td> 外，
    // 例如从一个 <tr> 到另一个 <tr>
    if (!currentElem) return;

    // 我们将要离开这个元素 —— 去哪儿？可能是去一个后代？
    let relatedTarget = event.relatedTarget;

    while (relatedTarget) {
      // 到父链上并检查 —— 我们是否还在 currentElem 内
      // 然后发现，这只是一个内部移动 —— 忽略它
      if (relatedTarget == currentElem) return;

      relatedTarget = relatedTarget.parentNode;
    }

    // 我们离开了 <td>。真的。
    onLeave(currentElem);
    currentElem = null;
  };

  // 任何处理进入/离开一个元素的函数
  function onEnter(elem) {
    elem.style.background = 'pink';

    // 在文本区域显示它
    text6.value += `over -> ${currentElem.tagName}.${currentElem.className}\n`;
    text6.scrollTop = 1e6;
  }

  function onLeave(elem) {
    elem.style.background = '';

    // 在文本区域显示它
    text6.value += `out <- ${elem.tagName}.${elem.className}\n`;
    text6.scrollTop = 1e6;
  }
</script>
<div data-tooltip="这是房子的内部" id="house">
    <div data-tooltip="这里是屋顶" id="roof"></div>
    <p>从前有一个猪妈妈，她养了三只小猪。</p>
    <p>三只小猪长得很快快，妈妈对它们说：“你们太大了，不能住在这里了，你们自己去盖房子吧，但要小心不要让狼抓到你们。”</p>
    <p>三只小猪出发了。 “我们会注意不要让狼抓住我们，”他们说。</p>
    <p>
        很快，它们遇到了一个男人。
        <a href="https://en.wikipedia.org/wiki/The_Three_Little_Pigs" data-tooltip="继续阅读...">
            鼠标悬浮在我上
        </a>
    </p>
</div>
<script>
  let tooltip;

  document.onmouseover = function(event) {
    // important: a fast-moving mouse may "jump" right to a child on an annotated node, skipping the parent
    // so mouseover may happen on a child.

    let anchorElem = event.target.closest('[data-tooltip]');

    if (!anchorElem) return;

    // show tooltip and remember it
    tooltip = showTooltip(anchorElem, anchorElem.dataset.tooltip);
  };

  document.onmouseout = function() {
    // it is possible that mouseout triggered, but we're still inside the element
    // (its target was inside, and it bubbled)
    // but in this case we'll have an immediate mouseover,
    // so the tooltip will be destroyed and shown again
    //
    // luckily, the "blinking" won't be visible,
    // as both events happen almost at the same time
    if (tooltip) {
      tooltip.remove();
      tooltip = false;
    }
  };

  function showTooltip(anchorElem, html) {
    let tooltipElem = document.createElement('div');
    tooltipElem.className = 'tooltip';
    tooltipElem.innerHTML = html;
    document.body.append(tooltipElem);

    let coords = anchorElem.getBoundingClientRect();

    // position the tooltip over the center of the element
    let left = coords.left + (anchorElem.offsetWidth - tooltipElem.offsetWidth) / 2;
    if (left < 0) left = 0;

    let top = coords.top - tooltipElem.offsetHeight - 5;
    if (top < 0) {
      top = coords.top + anchorElem.offsetHeight + 5;
    }

    tooltipElem.style.left = left + 'px';
    tooltipElem.style.top = top + 'px';

    return tooltipElem;
  }
</script>
<div id="elem5" class="clock">
    <span class="hours">12</span> :
    <span class="minutes">30</span> :
    <span class="seconds">00</span>
</div>
<div id="tooltip2" hidden>Tooltip</div>
<script>
  class HoverIntent {

    constructor({
      sensitivity = 0.1, // speed less than 0.1px/ms means "hovering over an element"
      interval = 100,    // measure mouse speed once per 100ms
      elem5,
      over,
      out,
    }) {
      this.sensitivity = sensitivity;
      this.interval = interval;
      this.elem5 = elem5;
      this.over = over;
      this.out = out;

      // make sure "this" is the object in event handlers.
      this.onMouseMove = this.onMouseMove.bind(this);
      this.onMouseOver = this.onMouseOver.bind(this);
      this.onMouseOut = this.onMouseOut.bind(this);

      // and in time-measuring function (called from setInterval)
      this.trackSpeed = this.trackSpeed.bind(this);

      elem5.addEventListener('mouseover', this.onMouseOver);

      elem5.addEventListener('mouseout', this.onMouseOut);

    }

    onMouseOver(event) {

      if (this.isOverElement) {
        // if we're over the element, then ignore the event
        // we are already measuring the speed
        return;
      }

      this.isOverElement = true;

      // after every mousemove we'll be check the distance
      // between the previous and the current mouse coordinates
      // if it's less than sensivity, then the speed is slow

      this.prevX = event.pageX;
      this.prevY = event.pageY;
      this.prevTime = Date.now();

      elem5.addEventListener('mousemove', this.onMouseMove);
      this.checkSpeedInterval = setInterval(this.trackSpeed, this.interval);
    }

    onMouseOut(event) {
      // if left the element
      if (!event.relatedTarget || !elem5.contains(event.relatedTarget)) {
        this.isOverElement = false;
        this.elem5.removeEventListener('mousemove', this.onMouseMove);
        clearInterval(this.checkSpeedInterval);
        if (this.isHover) {
          // if there was a stop over the element
          this.out.call(this.elem, event);
          this.isHover = false;
        }
      }
    }

    onMouseMove(event) {
      this.lastX = event.pageX;
      this.lastY = event.pageY;
      this.lastTime = Date.now();
    }

    trackSpeed() {

      let speed;

      if (!this.lastTime || this.lastTime == this.prevTime) {
        // cursor didn't move
        speed = 0;
      } else {
        speed = Math.sqrt(
            Math.pow(this.prevX - this.lastX, 2) +
            Math.pow(this.prevY - this.lastY, 2),
        ) / (this.lastTime - this.prevTime);
      }

      if (speed < this.sensitivity) {
        clearInterval(this.checkSpeedInterval);
        this.isHover = true;
        this.over.call(this.elem);
      } else {
        // speed fast, remember new coordinates as the previous ones
        this.prevX = this.lastX;
        this.prevY = this.lastY;
        this.prevTime = this.lastTime;
      }
    }

    destroy() {
      elem5.removeEventListener('mousemove', this.onMouseMove);
      elem5.removeEventListener('mouseover', this.onMouseOver);
      elem5.removeEventListener('mouseout', this.onMouseOut);
    }
  }

  // let elem = document.getElementById('elem5');

  new HoverIntent({
    elem5,
    over() {
      tooltip2.style.left = elem5.getBoundingClientRect().left + 5 + 'px';
      tooltip2.style.top = elem5.getBoundingClientRect().bottom + 5 + 'px';
      tooltip2.hidden = false;
    },
    out() {
      tooltip2.hidden = true;
    },
  });
</script>
</body>
</html>